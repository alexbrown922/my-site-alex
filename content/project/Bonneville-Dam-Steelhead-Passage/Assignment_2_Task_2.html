---
title: "Bonneville Dam Steelhead Trout Passage"
author: "Alex Brown"
date: "2/20/2020"
output: html_document
---



<p>The Columbia Basin Research Center collects data on the number of fish that pass through the Columbia River from British Columbia through Oregon. Data is collected at each dam along the river, including the Bonneville dam in Oregon through the Data Access in Real Time (DART) program.</p>
<div id="bonneville-dam" class="section level3">
<h3>Bonneville Dam</h3>
<p>(Anonymous Traveler Photo)</p>
<div class="figure">
<img src="bonneville.jpg" />

</div>
<p>The following project will analyze the passage of steelhead trout through the Bonneville Dam from 1939 - 2019. Analysis will look at different patterns of passage daily, seasonally, and annually through the dam. The data is from <a href="http://www.cbr.washington.edu/dart/query/adult_graph_text">Columbia Basin Research.</a></p>
</div>
<div id="code-steps" class="section level3">
<h3>Code Steps</h3>
<p>Load packages</p>
<pre class="r"><code>library(tidyverse)
library(janitor)
library(feasts)
library(tsibble)
library(lubridate)</code></pre>
<p>Read in data</p>
<pre class="r"><code>steelhead_raw &lt;- read_csv(&quot;cbr_fish_passage_bonneville_allyrs_steelhead.csv&quot;) %&gt;% 
  clean_names()</code></pre>
<p>Tidy the data</p>
<pre class="r"><code>steelhead &lt;- steelhead_raw %&gt;%
  drop_na(value) %&gt;% #remove NA values
  filter(value&gt;=0) %&gt;% #remove negative values
  separate(mm_dd, into=c(&quot;day&quot;, &quot;month&quot;)) %&gt;% #separate month from day
  mutate(yr_mo_day = paste(year, match(month,month.abb), day, sep=&quot;-&quot;), 
         yr_mo = paste(year, match(month,month.abb), sep=&quot;-&quot;),
         date = as.Date(yr_mo_day)) %&gt;% 
  filter(!is.na(date)) %&gt;% #remove leap year date(s)
  mutate(year_month = tsibble::yearmonth(yr_mo_day)) %&gt;% 
  select(&quot;year&quot;, &quot;year_month&quot;, &quot;yr_mo&quot;, &quot;date&quot;, &quot;value&quot;) # select relevant columns</code></pre>
</div>
<div id="daily-data" class="section level3">
<h3>Daily Data</h3>
<pre class="r"><code>steelhead_day &lt;- ggplot(data=steelhead, aes(x=date, y=value)) +
  geom_line() +
  xlab(&quot;Date&quot;) +
  ylab(&quot;Number of fish&quot;) +
  theme_minimal()

steelhead_day</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Figure 1. Amount of Steelhead Trout per day passing through Bonneville Dam (1939 - 2019).</p>
<p>There seems to be an aspect of seasonality to the number of Steelhead Trout passing through the dam. This could relate to species-specific migration habits.</p>
<p>By looking at the first 3000 observations, we can see this seasonality more clearly…</p>
<pre class="r"><code>steelhead_trimmed &lt;- tail(steelhead, n=3000)
ggplot(data=steelhead_trimmed, aes(x=date, y=value)) +
  geom_line()</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="monthly-data" class="section level3">
<h3>Monthly Data</h3>
<pre class="r"><code>steelhead_month &lt;- ggplot(data=steelhead, aes(x=year_month, y=value)) +
  geom_line()
steelhead_month</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="yearly-data" class="section level3">
<h3>Yearly Data</h3>
<pre class="r"><code>steelhead_year &lt;- ggplot(data=steelhead, aes(x=year, y=value)) +
  geom_line()
steelhead_year</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="plot-steelhead-passage-by-season" class="section level3">
<h3>Plot Steelhead Passage by Season</h3>
<pre class="r"><code>#Make a tsibble
steelhead_ts &lt;- as_tsibble(steelhead, index= year_month)
duplicates(steelhead, index=year_month)</code></pre>
<pre><code>## # A tibble: 0 x 5
## # … with 5 variables: year &lt;dbl&gt;, year_month &lt;mth&gt;, yr_mo &lt;chr&gt;, date &lt;date&gt;,
## #   value &lt;dbl&gt;</code></pre>
<pre class="r"><code>#plot tsibble plots
steelhead_ts %&gt;% autoplot(value)</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>steelhead_ts %&gt;% gg_subseries(value) +
  geom_line(aes(color=year)) +
  xlab(&quot;Date&quot;) +
  ylab(&quot;Number of fish&quot;) +
  theme_minimal()</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>The months of July, August, and September seem to be the peak time for Steelhead Trout passage through the Bonneville Dam.</p>
<pre class="r"><code>steelhead_summary &lt;- steelhead %&gt;% 
  group_by(yr_mo) %&gt;%
  summarise(sums=sum(value)) %&gt;% 
  mutate(year_month = tsibble::yearmonth(yr_mo), 
         month = month(year_month, label = TRUE),
         year = year(year_month),
         sums=replace_na(sums, 0)) #replace all NA values w/ 0
# make a tsibble
steelhead_summary_ts &lt;- as_tsibble(steelhead_summary, index= year_month) %&gt;% 
  fill_gaps() 

#ggplot of seasons 
ggplot(data=steelhead_summary, aes(x=month, y=sums, group=year)) +
  geom_line(aes(color=year)) +
  scale_colour_gradientn(colours = c(&quot;red&quot;,&quot;yellow&quot;,&quot;blue&quot;)) +
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE)) +
  xlab(&quot;Month&quot;) +
  ylab(&quot;Number of fish&quot;) +
  theme_minimal()</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Figure 2. Amount of Steelhead Trout per season passing through Bonneville Dam (1939 - 2019).</p>
</div>
<div id="plot-steelhead-trout-passage-by-year" class="section level3">
<h3>Plot Steelhead Trout Passage by Year</h3>
<pre class="r"><code>steelhead_annual &lt;- steelhead_summary %&gt;% 
  group_by(year) %&gt;% 
  summarize(sumsofsums=sum(sums))
#ggplot of annual passage data
ggplot(data=steelhead_annual, aes(x=year, y=sumsofsums)) +
  geom_line() +
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE)) +
  xlab(&quot;Date&quot;) +
  ylab(&quot;Number of fish&quot;) +
  theme_bw()</code></pre>
<p><img src="/project/Bonneville-Dam-Steelhead-Passage/Assignment_2_Task_2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Figure 3. Amount of Steelhead Trout per year passing through Bonneville Dam (1939 - 2019).</p>
<p>Steelhead Trout passage through the Bonneville Dam was increasing from approximately 1980 to 2010, however there seems to be a steady decrease in the past decade.</p>
</div>
